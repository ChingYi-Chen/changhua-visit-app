import bcryptfrom db import get_conndef verify_user(username: str, password: str):    conn = get_conn()    cur = conn.cursor()    cur.execute("SELECT id, username, password_hash FROM users WHERE username = ?", (username,))    row = cur.fetchone()    conn.close()    if not row:        return None    ok = bcrypt.checkpw(password.encode("utf-8"), row["password_hash"].encode("utf-8"))    if not ok:        return None    return {"user_id": row["id"], "username": row["username"]}def hash_password(password: str) -> str:    hashed = bcrypt.hashpw(        password.encode("utf-8"),        bcrypt.gensalt()    )    return hashed.decode("utf-8")